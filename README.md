# Bot Server æ¡ˆä¾‹

ä¸€ä¸ªåŸºäºé“¾å¼å¤„ç†æ¶æ„çš„æ™ºèƒ½AgentæœåŠ¡ç«¯é¡¹ç›®ï¼Œå®ç°äº†"Agent + MCPï¼ˆModel Context Protocolï¼‰+ LangChain"çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **ç»Ÿä¸€ ReAct æ ¸å¿ƒ**ï¼šå°†ä¼ ç»Ÿçš„â€œæ„å›¾åˆ†æ â†’ æ‰§è¡Œâ€æ¨¡å¼ï¼Œç®€åŒ–ä¸ºç»Ÿä¸€çš„ `ReAct` æ‰§è¡Œå¾ªç¯ã€‚æ¨¡å‹åœ¨å¾ªç¯çš„ç¬¬ä¸€æ­¥å³å¯å†³å®šæ˜¯è°ƒç”¨å·¥å…·è¿˜æ˜¯ç›´æ¥å›ç­”ã€‚
- **ReActå†³ç­–å¾ªç¯**ï¼šæ”¯æŒå¤šæ¬¡ `tool_call` â†’ `observation` â†’ `final_answer`
- **ç»Ÿä¸€Agentç¼–æ’**ï¼šæ”¯æŒ1-Nä¸ªAgentçš„ç»Ÿä¸€å¤„ç†ï¼Œä¸å†åŒºåˆ†å•å¤šAgentæ¨¡å¼
- **MCPå¤–éƒ¨å·¥å…·**ï¼šè‡ªåŠ¨å‘ç°å’Œè°ƒç”¨å¤–éƒ¨MCPå·¥å…·æœåŠ¡
- **æ™ºèƒ½ç½‘é¡µæŠ“å–**ï¼šé›†æˆå®Œæ•´çš„ç½‘é¡µå†…å®¹æŠ“å–ä¸LLMé©±åŠ¨çš„æ™ºèƒ½æ ¼å¼åŒ–
- **æµå¼è¾“å‡º**ï¼šå®Œæ•´çš„HTTPæ–‡æœ¬æµè¾“å‡º
- **æ‰§è¡Œç­–ç•¥**ï¼šç»Ÿä¸€ä¸º Prompt æ¨¡å¼ï¼ˆå·²ç§»é™¤ Function æ¨¡å¼ï¼‰
- **å“åº”å¢å¼º**ï¼šè‡ªåŠ¨ä¼˜åŒ–å’Œæ ¼å¼åŒ–ReActç»“æœ
- **è‡ªç®¡ç†å·¥å…·æ³¨å†Œ**ï¼šæ¯ä¸ªMCPå·¥å…·ç®¡ç†è‡ªå·±çš„æ³¨å†Œä¿¡æ¯ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
Bot Server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agent/                              # Agentæ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ chain/                          # é“¾å¼å¤„ç†å¼•æ“
â”‚   â”‚   â”‚   â”œâ”€â”€ executors/                  # ReActæ‰§è¡Œå™¨ (åº•å±‚å®ç°)
â”‚   â”‚   â”‚   â”œâ”€â”€ steps/                      # é“¾å¼å¤„ç†æ­¥éª¤ (ReAct, å“åº”å¢å¼ºç­‰)
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts/                    # LangChainæç¤ºè¯æ¨¡æ¿
â”‚   â”‚   â”‚   â””â”€â”€ agent-chain.ts              # ä¸»é“¾å¼å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ mcp/                            # MCPåè®® (å®¢æˆ·ç«¯/æœåŠ¡ç«¯)
â”‚   â”‚   â””â”€â”€ agent.ts                        # Agentæ ¸å¿ƒç±»å®šä¹‰
â”‚   â”œâ”€â”€ orchestration/                      # Agentç¼–æ’å±‚
â”‚   â”‚   â”œâ”€â”€ Dashboard/                      # Dashboardå­Agenté›†åˆ
â”‚   â”‚   â”‚   â””â”€â”€ WebHelper/                  # ç½‘é¡µæŠ“å–åŠ©æ‰‹Agent
â”‚   â”‚   â”œâ”€â”€ Leader/                         # Leader Agent (è·¯ç”±/å…œåº•)
â”‚   â”‚   â”œâ”€â”€ bootstrap.ts                    # æœåŠ¡å¯åŠ¨ä¸Agentæ³¨å†Œ
â”‚   â”‚   â”œâ”€â”€ llm.ts                          # LLMæ¨¡å‹å·¥å‚
â”‚   â”‚   â”œâ”€â”€ manager.ts                      # Agentç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ router.ts                       # æ™ºèƒ½è·¯ç”±é€‰æ‹©
â”‚   â”œâ”€â”€ controllers/                        # æ§åˆ¶å™¨å±‚ (HTTP API)
â”‚   â”œâ”€â”€ services/                           # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ routes/                             # Expressè·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ middlewares/                        # Expressä¸­é—´ä»¶
â”‚   â”œâ”€â”€ utils/                              # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ config/                             # åº”ç”¨é…ç½®
â”œâ”€â”€ docs/                                   # æ¶æ„ä¸æµç¨‹æ–‡æ¡£
â”œâ”€â”€ public/                                 # é™æ€èµ„æº (æµ‹è¯•å‰ç«¯é¡µé¢)
â””â”€â”€ package.json                            # é¡¹ç›®ä¾èµ–ä¸è„šæœ¬
```

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd bot-server

# å®‰è£…ä¾èµ–
pnpm install

# è®¾ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„APIå¯†é’¥
```

### å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼
pnpm dev

# ç”Ÿäº§æ¨¡å¼
pnpm build
pnpm start
```

### æµ‹è¯•
public/chat.html æ˜¯æµ‹è¯•ç½‘é¡µã€‚

## ğŸ”„ å¤„ç†æµç¨‹

```
ç”¨æˆ·è¯·æ±‚
    â†“
ChatController
    â†“
ChatService.runChainStream()
    â†“
ç»Ÿä¸€Agentç¼–æ’ (runWithLeader)
    â†“
æ˜¾å¼æŒ‡å®š â†’ æ™ºèƒ½è·¯ç”±(1-Nä¸ªAgent) â†’ Leaderå…œåº•
    â†“
AgentChain.runChain() Ã— N
    â†“
ReActæ‰§è¡Œ (ReActExecutionStep)
    â†“
å“åº”å¢å¼º (ResponseEnhancementStep)
    â†“
æµå¼è¾“å‡º
```

## ğŸ› ï¸ æ‰§è¡Œç­–ç•¥

### Prompt æ¨¡å¼
- **é€‚ç”¨åœºæ™¯**: æ‰€æœ‰æ”¯æŒJSONè¾“å‡ºçš„æ¨¡å‹
- **ç‰¹ç‚¹**: é€šè¿‡æç¤ºè¯çº¦æŸè¾“å‡ºReAct JSONæ ¼å¼
- **ä¼˜åŠ¿**: é€šç”¨æ€§å¼ºï¼Œå…¼å®¹æ€§å¥½
- **åŠ£åŠ¿**: Tokenå¼€é”€ç•¥é«˜

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ReActæµç¨‹](./docs/react-flow.md)
- [A2A è·¯ç”±/å¯åŠ¨æµç¨‹](./docs/a2a-flow.md)
- [MCPåè®®æ–‡æ¡£](https://modelcontextprotocol.io/)
