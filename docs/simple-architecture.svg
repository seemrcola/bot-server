<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- 简单的渐变 -->
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
    </linearGradient>
    
    <!-- 箭头 -->
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333"/>
    </marker>
  </defs>

  <!-- 背景 -->
  <rect width="800" height="600" fill="#fafafa" stroke="#ddd" stroke-width="1"/>
  
  <!-- 标题 -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#333">
    MCP 系统架构 - 学习版
  </text>
  
  <!-- 用户 -->
  <circle cx="100" cy="100" r="30" fill="url(#blueGrad)" stroke="#1976d2" stroke-width="2"/>
  <text x="100" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">👤</text>
  <text x="100" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">用户</text>
  <text x="100" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">输入消息</text>
  
  <!-- Chat Service -->
  <rect x="200" y="70" width="120" height="60" rx="10" fill="url(#blueGrad)" stroke="#1976d2" stroke-width="2"/>
  <text x="260" y="90" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">🌐 Chat Service</text>
  <text x="260" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">服务入口</text>
  <text x="260" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">HTTP/WebSocket</text>
  
  <!-- MCP Agent -->
  <rect x="400" y="70" width="120" height="60" rx="10" fill="url(#greenGrad)" stroke="#388e3c" stroke-width="2"/>
  <text x="460" y="90" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">🤖 MCP Agent</text>
  <text x="460" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">总控制器</text>
  <text x="460" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">流程协调</text>
  
  <!-- Intent Analyzer -->
  <rect x="150" y="180" width="120" height="60" rx="10" fill="url(#greenGrad)" stroke="#388e3c" stroke-width="2"/>
  <text x="210" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">🔍 意图分析</text>
  <text x="210" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Intent Analyzer</text>
  <text x="210" y="228" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">任务分解</text>
  
  <!-- Task Executor -->
  <rect x="300" y="180" width="120" height="60" rx="10" fill="url(#greenGrad)" stroke="#388e3c" stroke-width="2"/>
  <text x="360" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">⚡ 任务执行</text>
  <text x="360" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Task Executor</text>
  <text x="360" y="228" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">并行处理</text>
  
  <!-- LLM Processor -->
  <rect x="450" y="180" width="120" height="60" rx="10" fill="url(#greenGrad)" stroke="#388e3c" stroke-width="2"/>
  <text x="510" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">🧮 LLM处理</text>
  <text x="510" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">LLM Processor</text>
  <text x="510" y="228" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">文本生成</text>
  
  <!-- Tools -->
  <rect x="100" y="320" width="100" height="50" rx="8" fill="url(#orangeGrad)" stroke="#f57c00" stroke-width="2"/>
  <text x="150" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">🎭 JoJo Tool</text>
  <text x="150" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">具体工具</text>
  
  <rect x="220" y="320" width="100" height="50" rx="8" fill="url(#orangeGrad)" stroke="#f57c00" stroke-width="2"/>
  <text x="270" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">🌤️ Weather</text>
  <text x="270" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">天气工具</text>
  
  <rect x="340" y="320" width="100" height="50" rx="8" fill="url(#orangeGrad)" stroke="#f57c00" stroke-width="2"/>
  <text x="390" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">🔧 其他工具</text>
  <text x="390" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">扩展工具</text>
  
  <!-- DeepSeek API -->
  <rect x="500" y="320" width="120" height="50" rx="8" fill="#fce4ec" stroke="#c2185b" stroke-width="2"/>
  <text x="560" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333">🤖 DeepSeek API</text>
  <text x="560" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">外部LLM</text>
  
  <!-- 数据流箭头 -->
  <g stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrow)">
    <!-- 主流程 -->
    <line x1="130" y1="100" x2="200" y2="100"/>
    <line x1="320" y1="100" x2="400" y2="100"/>
    <line x1="460" y1="130" x2="210" y2="180"/>
    <line x1="270" y1="210" x2="300" y2="210"/>
    <line x1="420" y1="210" x2="450" y2="210"/>
    
    <!-- 工具调用 -->
    <line x1="360" y1="240" x2="150" y2="320"/>
    <line x1="360" y1="240" x2="270" y2="320"/>
    <line x1="360" y1="240" x2="390" y2="320"/>
    
    <!-- LLM调用 -->
    <line x1="510" y1="240" x2="560" y2="320"/>
  </g>
  
  <!-- 流程步骤标注 -->
  <g font-family="Arial, sans-serif" font-size="10" fill="#666">
    <text x="165" y="95">1. 请求</text>
    <text x="360" y="95">2. 处理</text>
    <text x="335" y="155">3. 分析</text>
    <text x="285" y="205">4</text>
    <text x="435" y="205">5</text>
    <text x="225" y="280">6. 工具调用</text>
    <text x="535" y="280">7. LLM调用</text>
  </g>
  
  <!-- 说明文字 -->
  <g font-family="Arial, sans-serif" fill="#333">
    <text x="50" y="450" font-size="14" font-weight="bold">处理流程说明：</text>
    <text x="50" y="470" font-size="12">1. 用户发送消息给Chat Service</text>
    <text x="50" y="485" font-size="12">2. Chat Service转发给MCP Agent总控制器</text>
    <text x="50" y="500" font-size="12">3. MCP Agent调用Intent Analyzer分析用户意图</text>
    <text x="50" y="515" font-size="12">4. 根据意图类型，Task Executor执行相应任务</text>
    <text x="50" y="530" font-size="12">5. 工具任务调用具体工具，简单任务调用LLM处理</text>
    <text x="50" y="545" font-size="12">6. 整合结果，生成友好回复返回给用户</text>
    
    <text x="450" y="450" font-size="14" font-weight="bold">核心特性：</text>
    <text x="450" y="470" font-size="12">✨ 智能意图识别</text>
    <text x="450" y="485" font-size="12">🔄 混合处理模式</text>
    <text x="450" y="500" font-size="12">🛠️ 可扩展工具系统</text>
    <text x="450" y="515" font-size="12">📝 提示词管理</text>
    <text x="450" y="530" font-size="12">⚡ 并行任务执行</text>
  </g>
  
  <!-- 版权 -->
  <text x="400" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#999">
    MCP 混合处理系统 - 学习版架构图
  </text>
</svg>
